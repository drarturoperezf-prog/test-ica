<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Test ICA ¬∑ Riesgo cardiometab√≥lico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root{
      --bg:#f5f7fb;
      --text:#0f172a;
      --muted:#475569;
      --card:#ffffff;
      --border:#e2e8f0;

      --green:#22c55e;
      --amber:#f59e0b;
      --red:#ef4444;

      --shadow: 0 14px 30px rgba(2,6,23,.08);
    }

    body{
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 0;
    }

    .screen{
      display:none;
      padding: 24px;
      max-width: 520px;
      margin: 0 auto;
      min-height: 100vh;
      box-sizing: border-box;
      align-content: center;
    }
    .screen.active{ display:block; }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 20px;
      box-shadow: var(--shadow);
    }

    h1{
      font-size: 34px;
      line-height: 1.08;
      margin: 0 0 14px 0;
      letter-spacing: -0.02em;
    }
    p{
      font-size: 16px;
      line-height: 1.55;
      color: var(--muted);
      margin: 0 0 12px 0;
    }
    .small{
      font-size: 14px;
      color: #64748b;
      margin-top: 10px;
      display:flex;
      gap:8px;
      align-items:center;
    }

    input{
      width: 100%;
      padding: 14px;
      font-size: 18px;
      border-radius: 12px;
      border: 1px solid var(--border);
      box-sizing: border-box;
      margin-top: 14px;
      outline: none;
      background:#fff;
    }
    input:focus{ border-color:#94a3b8; }

    .btn{
      display:block;
      width: 100%;
      margin-top: 18px;
      padding: 16px;
      font-size: 18px;
      font-weight: 800;
      border-radius: 14px;
      border: 0;
      cursor:pointer;
      text-align:center;
      text-decoration:none;
      box-sizing:border-box;
      user-select:none;
    }

    .btn.primary{
      background: linear-gradient(135deg, #111827 0%, #334155 60%, #0f172a 100%);
      color:#fff;
      box-shadow: 0 14px 30px rgba(2,6,23,.18);
    }
    .btn.primary:hover{ transform: translateY(-1px); }
    .btn.primary:active{ transform: translateY(0px); }

    .btn.secondary{
      background:#fff;
      color:#0f172a;
      border:1px solid var(--border);
      box-shadow: 0 10px 18px rgba(2,6,23,.06);
    }

    .row{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
    }

    /* Resultado */
    .result{
      margin-top: 14px;
      padding: 18px;
      border-radius: 16px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      background:#fff;
    }
    .result.low{
      background:#ecfdf3;
      border-color:#bbf7d0;
      border-left: 7px solid var(--green);
    }
    .result.moderate{
      background:#fffbeb;
      border-color:#fde68a;
      border-left: 7px solid var(--amber);
    }
    .result.high{
      background:#fef2f2;
      border-color:#fecaca;
      border-left: 7px solid var(--red);
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      font-weight: 800;
      font-size: 14px;
      margin: 10px 0 10px 0;
      border:1px solid;
      width: fit-content;
    }
    .badge.low{ background:#e7f6ed; color:#167a3c; border-color:#bbf7d0; }
    .badge.moderate{ background:#fff4d6; color:#8a5a00; border-color:#fde68a; }
    .badge.high{ background:#fde3e3; color:#a11a1a; border-color:#fecaca; }

    /* Sem√°foro */
    .semaforo{
      display:flex;
      justify-content:center;
      gap: 10px;
      margin: 12px 0 8px;
    }
    .luz{
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #ddd;
      box-shadow: inset 0 0 0 2px rgba(0,0,0,.08);
      opacity: .35;
    }
    .luz.on{ opacity: 1; }
    .luz.verde.on{ background: var(--green); }
    .luz.ambar.on{ background: var(--amber); }
    .luz.roja.on{ background: var(--red); }

    /* Barra */
    .riskbar{
      height: 10px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow:hidden;
      margin: 10px 0 14px;
    }
    .riskfill{
      height: 100%;
      width: 33%;
      background: var(--green);
    }
    .riskfill.moderate{ width: 66%; background: var(--amber); }
    .riskfill.high{ width: 100%; background: var(--red); }

    .hint{
      margin-top:10px;
      font-size: 13px;
      color:#64748b;
    }

    .error{
      margin-top: 12px;
      color: #b91c1c;
      font-weight: 700;
      display:none;
    }

    /* mini etiqueta ICA */
    .ica-pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background:#fff;
      font-weight: 800;
      width: fit-content;
      margin: 6px 0 6px;
    }
    .ica-pill span{
      font-weight: 900;
      color:#0f172a;
    }
  </style>
</head>

<body>

  <!-- PANTALLA 1 -->
  <div class="screen active" id="s1">
    <div class="card">
      <h1>¬øTu grasa abdominal est√° poniendo en riesgo tu salud?</h1>
      <p>
        Este test r√°pido se basa en el √≠ndice cintura-altura (ICA), un marcador m√°s √∫til que el peso para valorar riesgo cardiometab√≥lico.
      </p>
      <div class="small">‚è± 2 minutos ¬∑ No es un diagn√≥stico m√©dico.</div>
      <button class="btn primary" onclick="go(2)">Empezar el test</button>
    </div>
  </div>

  <!-- PANTALLA 2 -->
  <div class="screen" id="s2">
    <div class="card">
      <h1>¬øCu√°l es tu per√≠metro de cintura? (en cm)</h1>
      <p>M√≠dela a la altura del ombligo, sin apretar.</p>
      <input id="cintura" type="number" inputmode="numeric" placeholder="Ej. 95" />
      <div class="error" id="err2">Introduce un valor v√°lido (ej. 70‚Äì160).</div>
      <button class="btn primary" onclick="nextCintura()">Siguiente</button>
    </div>
  </div>

  <!-- PANTALLA 3 -->
  <div class="screen" id="s3">
    <div class="card">
      <h1>¬øCu√°l es tu altura? (en cm)</h1>
      <input id="altura" type="number" inputmode="numeric" placeholder="Ej. 170" />
      <div class="error" id="err3">Introduce un valor v√°lido (ej. 130‚Äì220).</div>
      <button class="btn primary" onclick="nextAltura()">Siguiente</button>
    </div>
  </div>

  <!-- PANTALLA 4 -->
  <div class="screen" id="s4">
    <div class="card">
      <h1>¬øTe cuesta especialmente perder grasa abdominal aunque hagas dieta o ejercicio?</h1>
      <button class="btn primary" onclick="answer(1)">S√≠</button>
      <button class="btn secondary" onclick="answer(0)">No</button>
    </div>
  </div>

  <!-- PANTALLA 5 -->
  <div class="screen" id="s5">
    <div class="card">
      <h1>¬øHas recuperado peso varias veces despu√©s de haberlo perdido?</h1>
      <button class="btn primary" onclick="answer(1)">S√≠</button>
      <button class="btn secondary" onclick="answer(0)">No</button>
    </div>
  </div>

  <!-- PANTALLA 6 -->
  <div class="screen" id="s6">
    <div class="card">
      <h1>¬øTienes o te han dicho alguna vez que tienes la tensi√≥n, el az√∫car o el colesterol altos?</h1>
      <button class="btn primary" onclick="answer(1)">S√≠</button>
      <button class="btn secondary" onclick="answer(0)">No</button>
    </div>
  </div>

  <!-- PANTALLA 7 (LEADS) -->
  <div class="screen" id="s7">
    <div class="card">
      <h1>Antes de ver tu resultado</h1>
      <p>D√©janos tus datos para enviarte tu resultado y, si lo deseas, ayudarte de forma individual.</p>

      <input id="leadNombre" type="text" placeholder="Nombre" autocomplete="name" />
      <input id="leadEmail" type="email" placeholder="Email" autocomplete="email" />
      <input id="leadTel" type="tel" placeholder="Tel√©fono" autocomplete="tel" />

      <div class="hint">Al enviar, aceptas que podamos contactarte por estos medios. (No sustituye consulta m√©dica.)</div>
      <div class="error" id="err7">Revisa: nombre, email v√°lido y tel√©fono.</div>

      <button class="btn primary" onclick="submitLeadsAndResult()">Ver mi resultado</button>
      <button class="btn secondary" onclick="skipLeads()">Omitir y ver resultado</button>
    </div>
  </div>

  <!-- PANTALLA 8 (RESULTADO) -->
  <div class="screen" id="s8">
    <div class="card">
      <h1 id="resultTitle"></h1>

      <div class="ica-pill">ICA: <span id="icaValue">‚Äî</span></div>

      <div class="result" id="resultBox">
        <!-- Sem√°foro -->
        <div class="semaforo">
          <div class="luz verde" id="luzVerde" title="Bajo"></div>
          <div class="luz ambar" id="luzAmbar" title="Moderado"></div>
          <div class="luz roja" id="luzRoja" title="Elevado"></div>
        </div>

        <!-- Barra -->
        <div class="riskbar">
          <div class="riskfill" id="riskFill"></div>
        </div>

        <!-- Badge -->
        <div class="badge low" id="riskBadge">Bajo</div>

        <p id="resultText"></p>
      </div>

      <a class="btn primary" href="https://www.instagram.com/dr.arturoperezf/" target="_blank" rel="noopener">
        Escribirme por Instagram
      </a>
    </div>
  </div>

<script>
  let clinicalScore = 0;
  let answersCount = 0;

  function go(n){
    for (let i=1;i<=8;i++){
      const el = document.getElementById('s'+i);
      if(el) el.classList.remove('active');
    }
    document.getElementById('s'+n).classList.add('active');
    window.scrollTo(0,0);
  }

  function nextCintura(){
    const v = parseFloat(document.getElementById('cintura').value);
    const ok = !isNaN(v) && v >= 50 && v <= 200;
    document.getElementById('err2').style.display = ok ? 'none' : 'block';
    if(ok) go(3);
  }

  function nextAltura(){
    const v = parseFloat(document.getElementById('altura').value);
    const ok = !isNaN(v) && v >= 120 && v <= 230;
    document.getElementById('err3').style.display = ok ? 'none' : 'block';
    if(ok) go(4);
  }

  function answer(val){
    clinicalScore += val;
    answersCount += 1;
    const nextScreen = 3 + answersCount; // 4->5->6
    if(nextScreen <= 6) go(nextScreen);
    else go(7); // antes del resultado pedimos leads
  }

  function isValidEmail(email){
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }

  function submitLeadsAndResult(){
    const nombre = (document.getElementById('leadNombre').value || '').trim();
    const email = (document.getElementById('leadEmail').value || '').trim();
    const tel = (document.getElementById('leadTel').value || '').trim();

    const ok = nombre.length >= 2 && isValidEmail(email) && tel.length >= 7;
    document.getElementById('err7').style.display = ok ? 'none' : 'block';
    if(!ok) return;

    // ‚ö†Ô∏è Importante:
    // GitHub Pages NO guarda datos por s√≠ solo.
    // Aqu√≠ dejamos preparado el "hook" para que lo conectes a un Google Sheet / CRM.
    // Por ahora solo continuamos al resultado.
    calculateResult();
  }

  function skipLeads(){
    calculateResult();
  }

  function calculateResult(){
    const cintura = parseFloat(document.getElementById('cintura').value);
    const altura = parseFloat(document.getElementById('altura').value);
    const ica = cintura / altura;

    let title = "";
    let text = "";
    let cls = "";

    // Regla simple: ICA + contexto (score)
    if (ica < 0.5 && clinicalScore === 0) {
      title = "üü¢ Resultado: Riesgo cardiometab√≥lico bajo";
      text  = "Tu √≠ndice cintura-altura est√° en un rango favorable y no aparecen se√±ales claras de alarma. Aun as√≠, la obesidad y el riesgo metab√≥lico cambian con el tiempo, el estr√©s y la edad.";
      cls = "low";
    } else if (ica < 0.6 || clinicalScore <= 1) {
      title = "üü† Resultado: Se√±ales de alerta metab√≥lica";
      text  = "Tu resultado sugiere que la grasa abdominal podr√≠a estar empezando a afectar a tu salud. Esto no se detecta bien solo con el peso o el IMC.";
      cls = "moderate";
    } else {
      title = "üî¥ Resultado: Riesgo cardiometab√≥lico elevado";
      text  = "Tu √≠ndice cintura-altura y tus respuestas indican un riesgo aumentado, especialmente a nivel cardiometab√≥lico. Esto no es un diagn√≥stico, pero s√≠ una se√±al clara para valorar tu caso con un profesional.";
      cls = "high";
    }

    // Pintar resultado
    document.getElementById('resultTitle').innerText = title;
    document.getElementById('resultText').innerText = text;

    const box = document.getElementById('resultBox');
    box.className = 'result ' + cls;

    const icaValueEl = document.getElementById('icaValue');
    if (icaValueEl) icaValueEl.textContent = ica.toFixed(2);

    // Sem√°foro + barra + badge
    const luzVerde = document.getElementById('luzVerde');
    const luzAmbar = document.getElementById('luzAmbar');
    const luzRoja  = document.getElementById('luzRoja');
    const riskFill = document.getElementById('riskFill');
    const riskBadge= document.getElementById('riskBadge');

    luzVerde.classList.remove('on');
    luzAmbar.classList.remove('on');
    luzRoja.classList.remove('on');

    riskFill.className = 'riskfill ' + (cls === 'low' ? '' : cls);
    riskBadge.className = 'badge ' + cls;

    if (cls === 'low') {
      luzVerde.classList.add('on');
      riskBadge.textContent = 'Bajo';
    } else if (cls === 'moderate') {
      luzAmbar.classList.add('on');
      riskBadge.textContent = 'Moderado';
    } else {
      luzRoja.classList.add('on');
      riskBadge.textContent = 'Elevado';
    }

    go(8);
  }
</script>

</body>
</html>
