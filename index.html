<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test ICA Â· Riesgo cardiometabÃ³lico</title>

<style>
body{
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:#f4f6fb;
  margin:0;
  color:#111;
}
.screen{display:none; max-width:480px; margin:0 auto; padding:24px;}
.screen.active{display:block;}
.card{
  background:#fff;
  border-radius:20px;
  padding:24px;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
}
h1{font-size:26px;margin-bottom:12px}
p{line-height:1.5;color:#444}

input{
  width:100%;
  padding:14px;
  margin-top:12px;
  border-radius:12px;
  border:1px solid #ddd;
  font-size:16px;
}

.btn{
  width:100%;
  padding:16px;
  border-radius:14px;
  border:none;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  margin-top:16px;
}
.btn.primary{
  background:linear-gradient(135deg,#111827,#334155);
  color:#fff;
}
.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  font-weight:700;
  font-size:14px;
}
.low{background:#dcfce7;color:#166534}
.moderate{background:#fef3c7;color:#92400e}
.high{background:#fee2e2;color:#991b1b}

.resultbox{
  border-radius:16px;
  padding:18px;
  margin-top:16px;
}
.result-low{background:#ecfdf5;border-left:6px solid #22c55e}
.result-moderate{background:#fffbeb;border-left:6px solid #f59e0b}
.result-high{background:#fef2f2;border-left:6px solid #ef4444}

.small{font-size:13px;color:#666}
.error{color:#b91c1c;font-size:14px;display:none}
</style>
</head>

<body>

<!-- PANTALLA 1 -->
<div class="screen active" id="s1">
  <div class="card">
    <h1>Â¿Tu grasa abdominal pone en riesgo tu salud?</h1>
    <p>Test rÃ¡pido basado en el Ã­ndice cintura-altura (ICA).</p>
    <button class="btn primary" onclick="showScreen('s2')">Empezar</button>
  </div>
</div>

<!-- PANTALLA 2 -->
<div class="screen" id="s2">
  <div class="card">
    <h1>Tus datos fÃ­sicos</h1>
    <input id="cintura" type="number" placeholder="Cintura (cm)">
    <input id="altura" type="number" placeholder="Altura (cm)">
    <button class="btn primary" onclick="calculateICA()">Continuar</button>
  </div>
</div>

<!-- PANTALLA 3 LEADS (OBLIGATORIOS) -->
<div class="screen" id="s3">
  <div class="card">
    <h1>Antes de ver tu resultado</h1>
    <p>DÃ©janos tus datos para enviarte tu resultado.</p>

    <input id="leadNombre" placeholder="Nombre">
    <input id="leadEmail" type="email" placeholder="Email">
    <input id="leadTel" placeholder="TelÃ©fono">

    <div class="error" id="errLead">Completa todos los campos.</div>

    <button class="btn primary" onclick="submitLeads()">Ver mi resultado</button>
    <p class="small">No sustituye consulta mÃ©dica.</p>
  </div>
</div>

<!-- PANTALLA 4 RESULTADO FINAL -->
<div class="screen" id="s4">
  <div class="card">
    <h1 id="resultTitle"></h1>
    <p><strong>ICA:</strong> <span id="icaValue"></span></p>

    <div id="resultBox" class="resultbox">
      <span class="badge" id="riskBadge"></span>
      <p id="resultText"></p>
    </div>

    <a class="btn primary"
       href="https://www.instagram.com/dr.arturoperezf/"
       target="_blank">
       Escribirme por Instagram
    </a>
  </div>
</div>

<script>
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// VARIABLES GLOBALES
let ICA = 0;
let RIESGO = "";

// CALCULO
function calculateICA(){
  const c = parseFloat(cintura.value);
  const a = parseFloat(altura.value);
  if(!c || !a) return;
  ICA = (c/a).toFixed(2);
  showScreen('s3');
}

// ENVIO LEADS + RESULTADO
function submitLeads(){
  const n = leadNombre.value.trim();
  const e = leadEmail.value.trim();
  const t = leadTel.value.trim();

  if(!n || !e || !t){
    errLead.style.display="block";
    return;
  }
  errLead.style.display="none";

  let title, text, cls;

  if(ICA < 0.5){
    title="ðŸŸ¢ Resultado: Riesgo cardiometabÃ³lico bajo";
    text="Tu ICA estÃ¡ en rango favorable.";
    cls="low";
  } else if(ICA < 0.6){
    title="ðŸŸ  Resultado: SeÃ±ales de alerta metabÃ³lica";
    text="PodrÃ­a existir acumulaciÃ³n de grasa abdominal.";
    cls="moderate";
  } else {
    title="ðŸ”´ Resultado: Riesgo cardiometabÃ³lico elevado";
    text="Riesgo aumentado. Valora consulta profesional.";
    cls="high";
  }

  resultTitle.innerText = title;
  icaValue.innerText = ICA;
  resultText.innerText = text;
  riskBadge.innerText = cls === "low" ? "Bajo" : cls === "moderate" ? "Moderado" : "Elevado";
  riskBadge.className = "badge " + cls;
  resultBox.className = "resultbox result-" + cls;

  // ðŸ”´ðŸ”´ðŸ”´ CAMBIA SOLO ESTA URL ðŸ”´ðŸ”´ðŸ”´
  fetch("PEGA_AQUI_TU_WEBAPP_URL",{
    method:"POST",
    mode:"no-cors",
    headers:{ "Content-Type":"application/x-www-form-urlencoded"},
    body:new URLSearchParams({
      nombre:n,
      email:e,
      telefono:t,
      ica:ICA,
      riesgo:cls
    })
  });

  localStorage.setItem("ica_done","1");
  showScreen('s4');
}

// BLOQUEO REINTENTOS
if(localStorage.getItem("ica_done")){
  alert("Este test solo puede realizarse una vez.");
}
</script>

</body>
</html>
